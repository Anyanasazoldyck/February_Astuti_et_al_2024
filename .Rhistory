library(readr)
markers <- read_csv("D:/PDAC_liver_metastasis/analysis/markers.csv")
View(markers)
BiocManager::install("yulab.utils", force = TRUE)
BiocManager::install("clusterProfiler", force = TRUE)
library(clusterProfiler)
library(org.Mm.eg.db)
library(AnnotationDbi)
cluster_id <- unique(markers$cluster)
cluster_id
View(markers)
head(org.Mm.eg.db)
org.Mm.eg.db
GO_list <- list()
for (c in cluster_id) {
genes <- markers %>%
filter(cluster == c,
avg_log2FC > 1,
p_val_adj < 0.01) %>%
pull(gene)
GO_results <- enrichGO(
gene = genes,
OrgDb = org.Mm.eg.db,
keyType = "SYMBOL",
ont = "BP"
)
GO_list[[as.character(c)]] <- GO_results
}
library(Seurat)
library(ggplot2)
library(patchwork)
library(dplyr)
for (c in cluster_id) {
genes <- markers %>%
filter(cluster == c,
avg_log2FC > 1,
p_val_adj < 0.01) %>%
pull(gene)
GO_results <- enrichGO(
gene = genes,
OrgDb = org.Mm.eg.db,
keyType = "SYMBOL",
ont = "BP"
)
GO_list[[as.character(c)]] <- GO_results
}
View(GO_list)
p <- plot(barplot(GO_list[[1]], showCatagory=5))
p <- plot(barplot(GO_list[[1]], showCategory=5))
barplot(GO_list[[1]], showCategory=5
barplot(GO_list[[1]], showCategory=5
p <- barplot(GO_list[[1]], showCategory=5)
p <- barplot(GO_list[[1]], showCategory = 5)
p <- barplot(GO_list[[1]], showCatagory = 5)
p <- plot(barplot(GO_list[[1]], showCatagory=5))
p <- plot(barplot(GO_list[[1]], showCategory=5))
for (id in names(GO_list )){
p <- plot(barplot(GO_list[[id]], showCategory=5))
png(paste0(Plots_file,"/",id,".png"))
p
dev.off()
}
# plot
Plots_file<-dir.create("analysis/GO_results")
for (id in names(GO_list )){
p <- plot(barplot(GO_list[[id]], showCategory=5))
png(paste0(Plots_file,"/",id,".png"))
p
dev.off()
}
Plots_file,"/",id,".png"
paste0(Plots_file,"/",id,".png")
# plot
Plots_file<-dir.create("analysis/GO_results")
# plot
Plots_file<-dir.create("analysis/GO_results/")
for (id in names(GO_list )){
p <- plot(barplot(GO_list[[id]], showCategory=5))
png(paste0(Plots_file,id,".png"))
p
dev.off()
}
# plot
Plots_file<-dir.create("analysis/GO_results")
# plot
Plots_file<- dir.create("analysis/GO_results", recursive = T)
#set working dir####
setwd("D:/PDAC_liver_metastasis")
Plots_file<- dir.create("analysis/GO_results", recursive = T)
for (id in names(GO_list )){
p <- plot(barplot(GO_list[[id]], showCategory=5))
png(paste0(Plots_file,id,".png"))
p
dev.off()
}
# plot
Plots_file <- "analysis/GO_results"
dir.create(Plots_file, recursive = TRUE, showWarnings = FALSE)
for (id in names(GO_list)) {
p <- barplot(GO_list[[id]], showCategory = 5)
png(file.path(Plots_file, paste0(id, ".png")),
width = 2000, height = 1600, res = 300)
print(p)
dev.off()
}
